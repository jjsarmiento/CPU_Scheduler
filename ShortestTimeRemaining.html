<html>
	<head>
		<style>
            body {
                font-family : Arial;
            }
            td {
                padding : 0.3em;
                text-align : center;
            }
            thead {
                font-weight : bold;
            }
            .gantt_block {
                text-align: center;
                padding: 0.4em;
                height: 5em;
                float: left;
                display: block;
                color: whitesmoke;
                font-weight: bold;
            }
            table {
                border-collapse : collapse;
            }
            .bubble {
                -webkit-box-shadow: 0px 0px 21px 1px rgba(0,0,0,0.84);
                -moz-box-shadow: 0px 0px 21px 1px rgba(0,0,0,0.84);
                box-shadow: 0px 0px 21px 1px rgba(0,0,0,0.84);
            }
		</style>
		<script src="js/jquery-3.1.0.min.js"></script>
		<script>
            var ready_queue = [];
            var cpu_process = null;
            var cpu_bursttime = null;
            var GLOBAL_startTime = null;
            var GLOBAL_endTime = null;
            var my_console = $('#cust_console');
            var my_gantt_chart = $('#gantt_chart');
            var my_colors = [
                '#E74C3C',
                '#8E44AD',
                '#16A085',
                '#D35400'
            ];

			$(document).ready(function(){

                $('input').each(function(){
                    $(this).val(Math.floor(Math.random() * 10) + 1);
                });

				$('#INIT_COMPUTE').click(function(){
					if(checkValues()){
                        for(var i=0; i < GET_BURSTTIME_TOTAL(); i++){
                            $('.arrival_time').each(function(index){ // check for arrivals
                                var curr_arrival_time = Math.round(parseFloat($(this).val()));
                                if(curr_arrival_time == parseFloat(i)){
                                    var process_number = index+1;
                                    var curr_bursttime = parseFloat($('[data-process="'+(process_number)+'"][class="burst_time"]').val());
                                    ready_queue.push(process_number+'?'+curr_bursttime);
                                }
                            });

                            if(cpu_process == null){ // if the cpu has no on going process
                                ready_queue.sort(function(a,b){ // sort queue by lowest bt first
                                    return a.split('?')[1] - b.split('?')[1]
                                });
                                if(ready_queue.length != 0){ // if ready queue has process waiting
                                    var temp_bt = ready_queue[0].split('?')[1];
                                    var temp_pr = ready_queue[0].split('?')[0];
                                    if(cpu_process == null){
                                        cpu_process = temp_pr;
                                        cpu_bursttime = temp_bt;
                                    }
                                }
                            }else{

                            }
                        }
					}
				});
				$('#methods').change(function(){
					location.href = $(this).val();
				})
			});

            function GET_PROCESS_WITH_LOWEST_BT(){

            }

            function GET_BURSTTIME_TOTAL(){
                var total = 0.0;
                $('.burst_time').each(function(index){
                    total += parseFloat($(this).val());
                });

                // adjust bt by the lowest bt in case lowest BT is not equal to zero
                if(GET_BURSTTIME_LOWEST() != 0){
                    total += GET_BURSTTIME_LOWEST();
                }

                return parseFloat(total);
            }

            function GET_ARRIVALTIME_HIGHEST(){
                var highest = 0;
                $('.arrival_time').each(function(){
                    if(highest == 0){
                        highest = parseFloat($(this).val());
                    }
                    if(parseFloat($(this).val()) > highest){
                        highest = parseFloat($(this).val());
                    }
                });
                return parseFloat(highest);
            }

            function GET_BURSTTIME_LOWEST(){
                var x = GET_BURSTTIME_HIGHEST();
                $('.burst_time').each(function(index){
                    var bt = parseFloat($(this).val());
                    if(bt < x){
                        x = bt;
                    }
                });

                return parseFloat(x);
            }

            function GET_BURSTTIME_HIGHEST(){
                var x = 0;
                $('.burst_time').each(function(index){
                    var bt = parseFloat($(this).val());
                    if(bt > 0){
                        x = bt;
                    }
                });

                return parseFloat(x);
            }

			function checkValues(){
				var flag = true;
				$('#cust_console').empty();
				$('.arrival_time').each(function(index){
					// check if arrival_time is filled out
					if($(this).val() == '' || !$.isNumeric($(this).val())){
						$('#cust_console').append('Please input a number for Arrival Time for Process P'+(index+1)+'<br/>');
						flag = false;
					}
				})
				$('.burst_time').each(function(index){
					// check if burst_time is filled out
					if($(this).val() == '' || !$.isNumeric($(this).val())){
						$('#cust_console').append('Please input a number for Burst Time for Process P'+(index+1)+'<br/>');
						flag = false;
					}
				})
				$('.priority').each(function(index){
					// check if burst_time is filled out
					if($(this).val() == '' || !$.isNumeric($(this).val())){
						$('#cust_console').append('Please input a number for Priority for Process P'+(index+1)+'<br/>');
						flag = false;
					}
				})

				return flag;
			}
		</script>
	</head>
	<body>
		Scheduling Methods
		<select id="methods">
			<option value="">SELECT A METHOD</option>
			<option value="index.html">First Come, First Serve (FCFS)</option>
			<option value="ShortestJobFirst.html">Shortest Job First</option>
			<option value="ShortestTimeRemaining.html">Shortest Time Remaining</option>
			<option value="PriorityNonPreemptive.html">Priority Non-Preemptive</option>
			<option value="PriorityPreemptive.html">Priority Preemptive</option>
			<option value="RoundRobin.html">Round Robin</option>
		</select>
		<br/>
		<br/>
		<h1>Shortest Time Remaining</h1>
        <table border="1">
            <thead>
            <tr>
                <td>Process Name</td>
                <td>Arrival Time</td>
                <td>Burst Time</td>
                <td>Turn-Around Time</td>
                <td>Waiting Time</td>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>P1</td>
                <td><input data-process="1" type="text" class="arrival_time" /></td>
                <td><input data-process="1" type="text" class="burst_time" /></td>
                <td><span class="TAT" id="P1_TAT"></span></td>
                <td><span class="WT" id="P1_WT"></span></td>
            </tr>
            <tr>
                <td>P2</td>
                <td><input data-process="2" type="text" class="arrival_time" /></td>
                <td><input data-process="2" type="text" class="burst_time" /></td>
                <td><span class="TAT" id="P2_TAT"></span></td>
                <td><span class="WT" id="P2_WT"></span></td>
            </tr>
            <tr>
                <td>P3</td>
                <td><input data-process="3" type="text" class="arrival_time" /></td>
                <td><input data-process="3" type="text" class="burst_time" /></td>
                <td><span class="TAT" id="P3_TAT"></span></td>
                <td><span class="WT" id="P3_WT"></span></td>
            </tr>
            <tr>
                <td>P4</td>
                <td><input data-process="4" type="text" class="arrival_time" /></td>
                <td><input data-process="4" type="text" class="burst_time" /></td>
                <td><span class="TAT" id="P4_TAT"></span></td>
                <td><span class="WT" id="P4_WT"></span></td>
            </tr>
            <tr>
                <td colspan="3">Average</td>
                <td><span id="AVG_TAT"></span></td>
                <td><span id="AVG_WT"></span></td>
            </tr>
            </tbody>
        </table>
        <br/>
        <div style="width: 80%">
            <div id="gantt_chart">
            </div>
        </div>
        <div style="clear: both;"></div>
        <p id="cust_console" style="color:red;"></p>
        <button id="INIT_COMPUTE">Compute</button>
	</body>
</html>